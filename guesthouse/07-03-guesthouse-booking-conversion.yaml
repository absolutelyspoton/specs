
components:
  GuestHouseBookingSystem:
    version: 3.1.0
    description: A multi-property guest house booking management system with visual timeline interface
    import:
      - file: ../common/common-definitions.yaml
        select:
          - UUID
          - DateTime
          - Date
    export:
      models:
        - House
        - Room
        - Booking
        - User
      controllers:
        - BookingController
        - AuthController
      services:
        - TimelineService
        - ValidationService
      events:
        - HouseCreated
        - RoomAdded
        - BookingCreated
        - BookingUpdated
        - BookingDeleted
        - UserAuthenticated
      views:
        - BookingManagerView
        - BookingDialog
    models:
      House:
        description: Represents a guest house property
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          name:
            name: name
            type: String
            required: true
            unique: false
          address:
            name: address
            type: String
            required: false
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
        relationships:
          rooms:
            name: rooms
            type: hasMany
            target: Room
        behaviors:
          addRoom:
            parameters:
              roomData:
                name: roomData
                type: Room
                required: true
                unique: false
            description: Adds a new room to the house
            returns: Room
            publishes:
              - RoomAdded
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
      Room:
        description: Represents a room within a guest house
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          houseId:
            name: houseId
            type: UUID
            required: true
            unique: false
          name:
            name: name
            type: String
            required: true
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
        relationships:
          house:
            name: house
            type: belongsTo
            target: House
          bookings:
            name: bookings
            type: hasMany
            target: Booking
        behaviors:
          checkAvailability:
            parameters:
              checkIn:
                name: checkIn
                type: Date
                required: true
                unique: false
              checkOut:
                name: checkOut
                type: Date
                required: true
                unique: false
            description: Checks if room is available for given dates
            returns: Boolean
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
      Booking:
        description: Represents a room booking
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          roomId:
            name: roomId
            type: UUID
            required: true
            unique: false
          guestName:
            name: guestName
            type: String
            required: true
            unique: false
          checkIn:
            name: checkIn
            type: Date
            required: true
            unique: false
          checkOut:
            name: checkOut
            type: Date
            required: true
            unique: false
          notes:
            name: notes
            type: String
            required: false
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
        relationships:
          room:
            name: room
            type: belongsTo
            target: Room
        behaviors:
          validateDates:
            parameters: {}
            description: Validates booking dates
            returns: Boolean
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
      User:
        description: Represents an authenticated system user
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          email:
            name: email
            type: String
            required: true
            unique: false
          isAllowed:
            name: isAllowed
            type: Boolean
            required: true
            unique: false
          lastLogin:
            name: lastLogin
            type: DateTime
            required: false
            unique: false
        behaviors:
          validateAccess:
            parameters: {}
            description: Validates if user has access to the system
            returns: Boolean
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
    controllers:
      BookingController:
        model: Booking
        description: Manages booking operations
        actions:
          createBooking:
            parameters:
              bookingData:
                name: bookingData
                type: Booking
                required: true
                unique: false
            description: Creates a new booking
            returns: Booking
            requires:
              - Room is available for selected dates
              - Guest name is provided
              - Check-out date is after check-in date
            publishes:
              - BookingCreated
          editBooking:
            parameters:
              bookingId:
                name: bookingId
                type: UUID
                required: true
                unique: false
              bookingData:
                name: bookingData
                type: Booking
                required: true
                unique: false
            description: Modifies an existing booking
            returns: Booking
            requires:
              - Booking exists
              - New dates are available
            publishes:
              - BookingUpdated
          deleteBooking:
            parameters:
              bookingId:
                name: bookingId
                type: UUID
                required: true
                unique: false
            description: Removes a booking
            returns: Boolean
            requires:
              - Booking exists
            publishes:
              - BookingDeleted
          selectHouse:
            parameters:
              houseId:
                name: houseId
                type: UUID
                required: true
                unique: false
            description: Selects a house for viewing bookings
            returns: String
      AuthController:
        model: User
        description: Handles user authentication
        actions:
          authenticate:
            parameters:
              credentials:
                name: credentials
                type: String
                required: true
                unique: false
            description: Authenticates a user
            returns: User
            requires:
              - User email is in allowlist
            publishes:
              - UserAuthenticated
          signout:
            parameters: {}
            description: Signs out a user
            returns: Boolean
    services:
      TimelineService:
        description: Provides timeline visualization capabilities
        operations:
          generateTimeline:
            parameters:
              startDate:
                name: startDate
                type: Date
                required: true
                unique: false
              endDate:
                name: endDate
                type: Date
                required: true
                unique: false
              houseId:
                name: houseId
                type: UUID
                required: true
                unique: false
            description: Generates timeline view for selected date range
            returns: String
          highlightWeekends:
            parameters:
              startDate:
                name: startDate
                type: Date
                required: true
                unique: false
              endDate:
                name: endDate
                type: Date
                required: true
                unique: false
            description: Highlights weekend dates in timeline
            returns: String
      ValidationService:
        description: Provides validation for bookings and dates
        operations:
          validateBookingDates:
            parameters:
              checkIn:
                name: checkIn
                type: Date
                required: true
                unique: false
              checkOut:
                name: checkOut
                type: Date
                required: true
                unique: false
            description: Validates booking date ranges
            returns: Boolean
          validateRoomAvailability:
            parameters:
              roomId:
                name: roomId
                type: UUID
                required: true
                unique: false
              checkIn:
                name: checkIn
                type: Date
                required: true
                unique: false
              checkOut:
                name: checkOut
                type: Date
                required: true
                unique: false
            description: Checks room availability for dates
            returns: Boolean
    events:
      HouseCreated:
        description: Triggered when a new guest house is created
        attributes:
          houseId:
            name: houseId
            type: UUID
            required: true
            unique: false
          name:
            name: name
            type: String
            required: true
            unique: false
          address:
            name: address
            type: String
            required: false
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
      RoomAdded:
        description: Triggered when a new room is added to a house
        attributes:
          roomId:
            name: roomId
            type: UUID
            required: true
            unique: false
          houseId:
            name: houseId
            type: UUID
            required: true
            unique: false
          name:
            name: name
            type: String
            required: true
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
      BookingCreated:
        description: Triggered when a new booking is created
        attributes:
          bookingId:
            name: bookingId
            type: UUID
            required: true
            unique: false
          roomId:
            name: roomId
            type: UUID
            required: true
            unique: false
          guestName:
            name: guestName
            type: String
            required: true
            unique: false
          checkIn:
            name: checkIn
            type: Date
            required: true
            unique: false
          checkOut:
            name: checkOut
            type: Date
            required: true
            unique: false
          notes:
            name: notes
            type: String
            required: false
            unique: false
          createdAt:
            name: createdAt
            type: DateTime
            required: true
            unique: false
      BookingUpdated:
        description: Triggered when an existing booking is modified
        attributes:
          bookingId:
            name: bookingId
            type: UUID
            required: true
            unique: false
          roomId:
            name: roomId
            type: UUID
            required: true
            unique: false
          guestName:
            name: guestName
            type: String
            required: true
            unique: false
          checkIn:
            name: checkIn
            type: Date
            required: true
            unique: false
          checkOut:
            name: checkOut
            type: Date
            required: true
            unique: false
          notes:
            name: notes
            type: String
            required: false
            unique: false
          updatedAt:
            name: updatedAt
            type: DateTime
            required: true
            unique: false
      BookingDeleted:
        description: Triggered when a booking is deleted
        attributes:
          bookingId:
            name: bookingId
            type: UUID
            required: true
            unique: false
          roomId:
            name: roomId
            type: UUID
            required: true
            unique: false
          deletedAt:
            name: deletedAt
            type: DateTime
            required: true
            unique: false
      UserAuthenticated:
        description: Triggered when a user successfully authenticates
        attributes:
          userId:
            name: userId
            type: UUID
            required: true
            unique: false
          email:
            name: email
            type: String
            required: true
            unique: false
          authenticatedAt:
            name: authenticatedAt
            type: DateTime
            required: true
            unique: false
    views:
      BookingManagerView:
        description: Main interface for managing bookings
        type: page
        model: Booking
        layout:
          houseSelector: top
          timelineView: below houseSelector filling space
          bookingList: bottom collapsible
        components:
          houseSelector:
            type: Dropdown
            properties:
              label: Select House
              placeholder: Choose a house
            events:
              onChange: BookingController.selectHouse
          timelineView:
            type: Timeline
            properties:
              viewOptions:
                - Week
                - 2 Weeks
                - Month
                - 3 Months
                - 6 Months
              highlightWeekends: true
            events:
              onDateSelect: BookingController.createBooking
              onBookingClick: BookingController.editBooking
          bookingList:
            type: Table
            properties:
              columns:
                - Guest
                - Room
                - Check-in
                - Check-out
                - Notes
            events:
              onRowClick: BookingController.showBookingDetails
      BookingDialog:
        description: Dialog for creating and editing bookings
        type: modal
        model: Booking
        layout:
          guestInput: top
          dateRange: below guestInput
          notesInput: below dateRange
        components:
          guestInput:
            type: TextInput
            properties:
              label: Guest Name
              required: true
          dateRange:
            type: DateRangePicker
            properties:
              label: Booking Dates
              required: true
          notesInput:
            type: TextArea
            properties:
              label: Notes
              optional: true
deployments: {}

components:
  ECommerceSystem:
    version: 3.1.0
    description: E-commerce system converted from legacy JSON format demonstrating steps and advanced features
    import:
      - file: ../common/common-definitions.yaml
        select:
          - UUID
          - DateTime
    export:
      models:
        - Product
        - Order
      controllers:
        - OrderController
        - ProductController
      events:
        - OrderPlaced
        - OrderStatusChanged
        - LowInventoryDetected
      views:
        - ProductCatalogView
    models:
      Product:
        description: Represents a product available for purchase
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          name:
            name: name
            type: String
            required: true
            unique: false
          description:
            name: description
            type: String
            required: false
            unique: false
          price:
            name: price
            type: Money
            required: true
            unique: false
          inventory:
            name: inventory
            type: Integer
            required: true
            unique: false
          inventoryThreshold:
            name: inventoryThreshold
            type: Integer
            required: false
            unique: false
            default: "5"
          category:
            name: category
            type: String
            required: true
            unique: false
        behaviors:
          decreaseInventory:
            parameters:
              quantity:
                name: quantity
                type: Integer
                required: true
                unique: false
            description: Reduces the inventory by the specified quantity
            returns: Boolean
            requires:
              - quantity > 0
              - inventory >= quantity
            ensures:
              - inventory reduced by quantity
            publishes:
              - LowInventoryDetected
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
      Order:
        description: Represents a customer order
        attributes:
          id:
            name: id
            type: UUID
            required: true
            unique: true
          customerId:
            name: customerId
            type: UUID
            required: true
            unique: false
          date:
            name: date
            type: DateTime
            required: true
            unique: false
          total:
            name: total
            type: Money
            required: true
            unique: false
          status:
            name: status
            type: String
            required: true
            unique: false
            default: pending
        behaviors:
          updateStatus:
            parameters:
              newStatus:
                name: newStatus
                type: String
                required: true
                unique: false
            description: Updates the order status
            returns: Order
            requires:
              - newStatus is valid
            ensures:
              - status updated
              - event published
            publishes:
              - OrderStatusChanged
          attachProfile:
            description: Attach a profile to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile exists and is compatible with this model
            ensures:
              - Profile is attached
              - Profile attributes are available
          detachProfile:
            description: Detach a profile from this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
            requires:
              - Profile is currently attached
            ensures:
              - Profile is detached
              - Profile attributes are no longer available
          hasProfile:
            description: Check if a profile is attached to this model instance
            parameters:
              profileName:
                name: profileName
                type: String
                required: true
                unique: false
            returns: Boolean
    controllers:
      OrderController:
        model: Order
        description: Handles order-related operations
        actions:
          placeOrder:
            parameters:
              customerId:
                name: customerId
                type: UUID
                required: true
                unique: false
              products:
                name: products
                type: String
                required: true
                unique: false
            description: Creates a new order for a customer
            returns: Order
            requires:
              - Customer exists and is active
              - All products exist and have sufficient inventory
            ensures:
              - New order is created with pending status
              - Product inventory is updated
              - Order confirmation is sent to customer
            publishes:
              - OrderPlaced
      ProductController:
        model: Product
        description: Handles product-related operations
        actions:
          filterByCategory:
            parameters:
              category:
                name: category
                type: String
                required: true
                unique: false
            description: Filters products by category
            returns: String
            requires:
              - Category is a valid product category
            ensures:
              - Returns filtered list of products
          searchProducts:
            parameters:
              searchTerm:
                name: searchTerm
                type: String
                required: true
                unique: false
            description: Searches products by name or description
            returns: String
            requires:
              - Search term is provided
            ensures:
              - Returns matching products
    events:
      OrderPlaced:
        description: Triggered when a new order is successfully placed
        attributes:
          orderId:
            name: orderId
            type: UUID
            required: true
            unique: false
          customerId:
            name: customerId
            type: UUID
            required: true
            unique: false
          orderTotal:
            name: orderTotal
            type: Money
            required: true
            unique: false
          orderItems:
            name: orderItems
            type: String
            required: true
            unique: false
      OrderStatusChanged:
        description: Triggered when an order's status changes
        attributes:
          orderId:
            name: orderId
            type: UUID
            required: true
            unique: false
          oldStatus:
            name: oldStatus
            type: String
            required: true
            unique: false
          newStatus:
            name: newStatus
            type: String
            required: true
            unique: false
      LowInventoryDetected:
        description: Triggered when product inventory falls below threshold
        attributes:
          productId:
            name: productId
            type: UUID
            required: true
            unique: false
          currentInventory:
            name: currentInventory
            type: Integer
            required: true
            unique: false
          threshold:
            name: threshold
            type: Integer
            required: true
            unique: false
    views:
      ProductCatalogView:
        description: Browse available products
        type: page
        model: Product
        layout:
          searchBar: top left
          categoryFilter: top right
          productList: filling remaining space below
        components:
          searchBar:
            type: SearchInput
            properties:
              placeholder: Search products...
            events:
              onSearch: ProductController.searchProducts
          categoryFilter:
            type: DropdownMenu
            properties:
              placeholder: Filter by category
              options:
                - label: All Categories
                  value: ""
                - label: Electronics
                  value: Electronics
                - label: Clothing
                  value: Clothing
                - label: Books
                  value: Books
            events:
              onChange: ProductController.filterByCategory
          productList:
            type: DataGrid
            properties:
              columns:
                - name
                - price
                - category
                - inventory
              sampleData:
                - id: "1"
                  name: Smartphone
                  description: Latest model smartphone with advanced features
                  price: 599.99
                  inventory: 50
                  inventoryThreshold: 10
                  category: Electronics
                - id: "2"
                  name: Laptop
                  description: High-performance laptop for professionals
                  price: 999.99
                  inventory: 30
                  inventoryThreshold: 5
                  category: Electronics
            events:
              onRowClick: showProductDetails
deployments: {}